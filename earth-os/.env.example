# EarthOS Environment Configuration Template

Copy this to each service directory as `.env` and update values as needed.

## Global Configuration

```bash
# Node environment
NODE_ENV=development

# Service ports
DAEMON_PORT=3002
SHELL_PORT=3003
APPSTORE_PORT=3004
UPDATER_PORT=3005
SIMULATOR_PORT=3006
CLOUD_PORT=8080

# Logging
LOG_LEVEL=info
LOG_DIR=./logs
```

## daemon/.env

```bash
# Server
PORT=3002
NODE_ENV=development

# Connected Services
SHELL_URL=http://localhost:3003
APPSTORE_URL=http://localhost:3004
UPDATER_URL=http://localhost:3005

# System
SYSTEM_DIR=./system
MAX_DEVICES=1000
AUTO_CLEANUP=true
CLEANUP_DAYS=30
```

## shell/.env

```bash
# Server
PORT=3003
NODE_ENV=development

# Cloud
CLOUD_API=https://earthling.tjstudios.xyz/api/logs
CLOUD_TIMEOUT=5000
CLOUD_RETRY=3

# Logging
LOGS_DIR=./logs
LOG_RETENTION_DAYS=90
MAX_LOGS_PER_FILE=10000

# Batch Logging
BATCH_SIZE=50
BATCH_TIMEOUT=5000
```

## appstore/.env

```bash
# Server
PORT=3004
NODE_ENV=development

# Registry
REGISTRY_FILE=./registry/registry.json
REGISTRY_BACKUP=true

# Cloud
CLOUD_API=https://earthling.tjstudios.xyz/api/apps
CLOUD_SYNC_INTERVAL=3600000

# Apps
APPS_DIR=./apps
MAX_APP_SIZE=536870912  # 512MB
ALLOW_BETA_APPS=true
```

## updater/.env

```bash
# Server
PORT=3005
NODE_ENV=development

# Updates
UPDATES_DIR=./updates
MAX_UPDATE_SIZE=1073741824  # 1GB

# Download
DOWNLOAD_TIMEOUT=600000
MAX_CONCURRENT=5
VERIFY_CHECKSUMS=true

# Rollback
KEEP_PREVIOUS_VERSION=true
AUTO_ROLLBACK_ON_FAILURE=true
```

## simulator/.env

```bash
# Server
PORT=3006
NODE_ENV=development

# Devices
DEVICES_DIR=./devices
MAX_DEVICES=100

# Simulation
CPU_UPDATE_INTERVAL=1000
MEMORY_UPDATE_INTERVAL=1000
SIMULATE_REAL_METRICS=true

# Dashboard
DASHBOARD_REFRESH=2000
```

## earthling-cli/.env

```bash
# Service URLs
DAEMON_URL=http://localhost:3002
SHELL_URL=http://localhost:3003
APPSTORE_URL=http://localhost:3004
UPDATER_URL=http://localhost:3005
SIMULATOR_URL=http://localhost:3006
CLOUD_URL=http://localhost:8080

# CLI
TIMEOUT=30000
VERBOSE=false
COLOR_OUTPUT=true

# Auth (when implemented)
AUTH_TOKEN=
AUTH_REFRESH_TOKEN=
```

## earthling-server/.env

```bash
# Server
PORT=8080
NODE_ENV=development
HOST=0.0.0.0

# Database (when using actual DB)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=earthos
DB_USER=earthos
DB_PASSWORD=changeme

# Security
JWT_SECRET=your-secret-key-here
JWT_EXPIRY=24h
REFRESH_TOKEN_EXPIRY=7d

# Cloud Services
STORAGE_BUCKET=earthos-uploads
CDN_BASE_URL=https://cdn.earthling.tjstudios.xyz

# Rate Limiting
RATE_LIMIT_WINDOW=15
RATE_LIMIT_MAX_REQUESTS=100

# CORS
CORS_ORIGIN=http://localhost:3001
CORS_CREDENTIALS=true

# Logging
LOG_LEVEL=info
LOG_DIR=./logs
LOG_RETENTION_DAYS=30

# Email (for notifications)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@earthling.com
SMTP_PASSWORD=
SMTP_FROM=EarthOS <noreply@earthling.com>

# Analytics
ANALYTICS_ENABLED=true
ANALYTICS_SAMPLE_RATE=1.0

# Features
ENABLE_WEBHOOKS=false
ENABLE_ANALYTICS=true
ENABLE_CRASH_REPORTS=true
```

## Production Configuration

For production deployment, update these:

```bash
# Global
NODE_ENV=production

# Security
JWT_SECRET=<generate-strong-random-key>
API_KEY=<generate-api-key>

# Database
DB_HOST=prod-db.internal
DB_PASSWORD=<use-secrets-manager>

# CDN
CDN_BASE_URL=https://cdn.earthling.tjstudios.xyz
ASSETS_CDN=https://assets.earthling.tjstudios.xyz

# CORS
CORS_ORIGIN=https://app.earthling.com

# Email
SMTP_PASSWORD=<use-secrets-manager>

# Monitoring
SENTRY_DSN=https://xxxxx@sentry.io/xxxxx
NEW_RELIC_LICENSE_KEY=<from-newrelic>

# Rate Limiting
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_WINDOW=60

# Logging
LOG_LEVEL=warn
LOG_DIR=/var/log/earthos
```

## Development Tips

1. **Use `.env.local`** for local overrides:
   ```bash
   cp .env .env.local
   # Edit .env.local with your local values
   ```

2. **Don't commit secrets:**
   ```bash
   echo ".env.local" >> .gitignore
   echo ".env.*.local" >> .gitignore
   ```

3. **Validate environment:**
   ```bash
   npm run validate-env
   ```

4. **Use different ports for multiple instances:**
   ```bash
   PORT=3007 npm run dev  # Alternative daemon
   ```

## Docker Environment

When using Docker, pass environment via:

```dockerfile
ENV PORT=3002
ENV NODE_ENV=production
ENV DAEMON_URL=http://daemon:3002
```

Or via docker-compose:
```yaml
environment:
  - PORT=3002
  - NODE_ENV=production
  - DAEMON_URL=http://daemon:3002
```

## Environment Validation

Add to each service for startup validation:

```typescript
import dotenv from 'dotenv';

dotenv.config();

const requiredEnvVars = ['PORT', 'NODE_ENV'];
const missingEnvVars = requiredEnvVars.filter(envVar => !process.env[envVar]);

if (missingEnvVars.length > 0) {
  console.error(`Missing required environment variables: ${missingEnvVars.join(', ')}`);
  process.exit(1);
}
```

## Secrets Management

For production, use a secrets manager:
- AWS Secrets Manager
- Google Cloud Secret Manager
- HashiCorp Vault
- Azure Key Vault

Example with AWS:
```javascript
const AWS = require('aws-sdk');
const secretsManager = new AWS.SecretsManager();

const getSecret = async (secretName) => {
  const data = await secretsManager.getSecretValue({ SecretId: secretName }).promise();
  return JSON.parse(data.SecretString);
};
```
